<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rick&Morty</title>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script type="text/javascript">
        function mostrarMensaje() {
            alert("Boton pulsado");
        }
        function mostrarJson() {
            var strBusqueda = document.getElementById('strBusqueda').value;
            axios.get("https://rickandmortyapi.com/api/character/?name=" + strBusqueda)
            .then( response => {
                alert(response.data.results[0].toString());    
            })
            .catch(function (error) {
                alert(error);
            })
        }
        function mostrarDatos() {
            var strBusqueda = document.getElementById('strBusqueda').value;
            axios.get("https://rickandmortyapi.com/api/character/?name=" + strBusqueda)
            .then( response => {
                //alert("Nombre: " + response.data.results[0].name + "\nEspecie: " + response.data.results[0].species);
                var idApi = response.data.results[0].id;
                var nombre = response.data.results[0].name;
                var estado = response.data.results[0].status;
                var especie = response.data.results[0].species;
                var genero = response.data.results[0].genre;
                var origen = response.data.results[0].origin.name;
                var localizacion = response.data.results[0].location.name;
                var imagen = response.data.results[0].image;

                document.getElementById('strId').value = idApi;
                document.getElementById('strNombre').value = nombre;
                document.getElementById('strEstado').value = estado;
                document.getElementById('strEspecie').value = especie;
                document.getElementById('strGenero').value = genero;
                document.getElementById('strOrigen').value = origen;
                document.getElementById('strLocalizacion').value = localizacion;
                document.getElementById('strImagen').value = imagen;
                document.getElementById('imagen').src = imagen;
                document.getElementById('imagen').style.display = "block";

            })
            .catch(error => {
                alert(error);
            })
        }

        function guardarDatos(){
            alert("Prueba mensaje");
            var idApi = document.getElementById('strId').value;
            var nombre = document.getElementById('strNombre').value;
            var estado = document.getElementById('strEstado').value;
            var especie = document.getElementById('strEspecie').value;
            var genero = document.getElementById('strGenero').value;
            var origen = document.getElementById('strOrigen').value;
            var localizacion = document.getElementById('strLocalizacion').value;
            var imagen = document.getElementById('strImagen').value;
            alert(idApi + " - " + nombre + " - " + estado + " - " +especie + " - " + genero + " - " + origen + " - " + localizacion + " - " + imagen);
            
           
            $.ajax({
                type: "POST",
                url: "scriptPhp.php",
                data: {idApi: idApi, nombre: nombre, estado: estado, especie: especie, genero: genero, origen: origen, localizacion: localizacion, imagen: imagen},
                success: function (response) {
                    alert(response);
                },
                error: function(){
                    alert("Error en el servidor");
                    alert(response);
                }
            });

            
        }

    </script>
</head>
<body>
    <h1>AAD T5 Ejercicios</h1>
        <h2>Ejercicio 6</h2>
        <p>Ahora toca procesar el JSON que te devuelve axios como “response”. Mira el ejemplo de la teoría e intenta acceder a cada uno de los campos que te interesen. Puedes mostrar cada campo en mensajes de alerta distintos</p>
        <p>
            <input type="text" value="Rick Sanchez" id="strBusqueda">
            <button id="Boton" onclick=mostrarDatos()>Buscar</button>
        </p>
        <p>
            <p>
                <p>ID:</p>
                <input type="text" value="" id="strId">
                <p>Nombre:</p>
                <input type="text" value="" id="strNombre">
                <p>Estado:</p>
                <input type="text" value="" id="strEstado">
                <p>Especie:</p>
                <input type="text" value="" id="strEspecie">
                <p>Genero:</p>
                <input type="text" value="" id="strGenero">
                <p>Origen:</p>
                <input type="text" value="" id="strOrigen">
                <p>Localizacion:</p>
                <input type="text" value="" id="strLocalizacion">
                <p>Imagen:</p>
                <img id="imagen" src="" alt="Imagen del personaje" style="display:none;">
                <input type="text" value="" id="strImagen">                
            </p>
            <p>
                <button id="Boton2" onclick=guardarDatos()>Guardar</button>
            </p>

        </p>
</body>
</html>